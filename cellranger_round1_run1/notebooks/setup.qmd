---
title: "setup"
format: html
---

```{r}
library(tibble)
```

```{r}
sample_info <- read_tsv("../data/metadata.tsv", show_col_types = FALSE)
sample_info
```

```{r}
tibble_list <- list()
for (i in seq_len(nrow(sample_info))) {
  sample_id <- sample_info$id[i]
  sample_dir <- sample_info$data_dir[i]
  fq1 <- list.files(path = sprintf("../data/%s/", sample_dir), pattern = "R1_001.fastq.gz")
  fq2 <- gsub(pattern = "R1_001.fastq.gz", replacement = "R2_001.fastq.gz", fq1)
  tib <- tibble(
    id = sample_id,
    feature_types = "Gene Expression",
    read1 = file.path("data", sample_dir, fq1),
    read2 = file.path("data", sample_dir, fq2),
    lane_number = seq_along(fq1),
    subsample_rate = ""
  )
  tibble_list[[sample_id]] <- tib
}
```

```{r}
tibble_combined <- do.call("rbind", tibble_list)
```

```{r}
readr::write_tsv(x = tibble_combined, file = "../config/pools.tsv")
```
